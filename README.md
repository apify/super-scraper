# Standby Crawler

Actor url: https://yh8jx5mCjfv69espW.apify.actor/

Example usage using axios:

```ts
const resp = await axios.get('https://yh8jx5mCjfv69espW.apify.actor/', {
    params: {
        url: 'https://apify.com/store',
        wait_for: '.ActorStoreItem-title',
        verbose: true,
        screenshot: true,
    },
    headers: {
        Authorization: 'Bearer YOUR_APIFY_TOKEN',
    },
});

console.log(resp.data);
```

Example using curl:

```
curl  -X GET \
  'https://yh8jx5mCjfv69espW.apify.actor/?url=https://apify.com/store&wait_for=.ActorStoreItem-title&screenshot=true&verbose=true' \
  --header 'Authorization: Bearer YOUR_APIFY_TOKEN'
```

## Supported params

| parameter | description |
| -------- | ------- |
| `url` | URL of the webpage to be scraped, required parameter. |
| `json_response` | Will return a verbose JSON response with additional details about the webpage. Can be either `true` or `false`, default `false`. |
| `extract_rules` | Stringified JSON with custom rules how to extract data from the webpage. More [here](#extract-rules). |
| `render_js` | Specify, if you want to scrape the webpage with or without using a headless browser, can be `true` or `false`, default `true`. |
| `screenshot` | Get screenshot of the browser's current viewport. If `json_response` is set to `true`, screenshot will be returned in base64. Can be `true` or `false`, default `false`. |
| `screenshot_full_page` | Get screenshot of the full page. If `json_response` is set to `true`, screenshot will be returned in base64. Can be `true` or `false`, default `false`. |
| `screenshot_selector` | Get screenshot of the element specified by the selector. If `json_response` is set to `true`, screenshot will be returned in base64. Must be a non-empty `string`. |
| `js_scenario` | Instructions that will be performed after loading the page. More [here](#js-scenario). |
| `wait` | Specify a duration in ms that the browsers will wait after loading the page. |
| `wait_for` | Specify a selector of an element for which the browser will wait after loading the page. |
| `wait_browser` | Can be one of: `load`, `domcontentloaded`, `networkidle`. |
| `block_resources` | Specify, if you want to block images and CSS. Can be `true` or `false`, default `true`. |
| `window_width` | Specify width of the browser's viewport. |
| `window_height` | Specify height of the browser's viewport. |
| `cookies` | Use custom cookies, must be in a string format: `cookie_name_1=cookie_value1;cookie_name_2=cookie_value_2`. |
| `own_proxy` | Use your own proxies in a format: `<protocol><username>:<password>@<host>:<port>`. |
| `premium_proxy` | Use IP addresses assigned to homes and offices of actual users. Reduced probability of being blocked. |
| `stealth_proxy` | Same as `premium_proxy`. |
| `country_code` | Use IP addresses that are geolocated to the specified country by specifying a 2-letter country [code](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2#Officially_assigned_code_elements).  If using code other than `US`, `premium_proxy` must be set to `true`. |
| `custom_google` | Use this option, if you want to scrape Google related websites (such as Google Shopping). Can be `true` or `false`, default `false`. |
| `return_page_source` | Return HTML of the website that gets returned in the response (before any Javascript rendering), can be `true` or `false`, default: `false`. |
| `transparent_status_code` | If response returns something other than a 200-299 or a 404, status code 500 will be returned. Set `true` to disable this behaviour and return the status code of the actual response. |
| `timeout` | Set maximum number of ms to get response from this Actor. |  
| `forward_headers` | If set to `true`, headers in a request to this Actor begining with prefix `Spb-` will be forwarded to the target webpage alongside headers generated by us (prefix will be trimmed). |
| `forward_headers_pure` | If set to `true`, only headers in a request to this Actor begining with prefix `Spb-` will be forwarded to the target webpage (prefix will be trimmed). |
| `device` | Can be either `desktop` (default) or `mobile`. |

### Extract rules

Specify a set of rules to scrape data from the target webpage. There are two ways how to create an extract rule: with shortened options or with full options:

#### shortened options:
- value for the given key serves as a `selector`
- using `@`, we can access attribute of the selected element

```json
{ 
    "title": "h1",
    "link": "a@href"
}
```

#### full options (+ nesting):

- `selector` is required,
- `type` can be either `item` (default) or `list`,
- `output` - how the result for these element(s) will look like, can be:
    - `text` (default option when `output` is omitted) - text of the element
    - `html` - HTML of the element
    - attribute name (starts with `@`, for example `@href`)
    - object with other extract rules for the given item (key + shortened or full options)
    - `table_json` or `table_array` to scrape a table in a json or array format
- `clean` - relevant when having `text` as `output`, specifies whether the text of the element should be trimmed of whitespaces (can be `true` or `false`, default `true`)

```json
{
    "custom key for links": {
        "selector": "a",
        "type": "list",
        "output": {
            "linkName" : {
                "selector": "a",
                "clean": "false"
            },
            "href": {
                "selector": "a",
                "output": "@href"
            }
        }

    }
}
```

#### example:
- this scrapes all links from [Apify Blog](https://blog.apify.com/) along with their titles
- axios:
```ts
const extractRules = {
    title: 'h1',
    allLinks: {
        selector: 'a',
        type: 'list',
        output: {
            title: 'a',
            link: 'a@href',
        },
    },
};

const resp = await axios.get('https://yh8jx5mCjfv69espW.apify.actor/', {
    params: {
        url: 'https://blog.apify.com/',
        extract_rules: JSON.stringify(extractRules),
        // verbose: true,
    },
    headers: {
        Authorization: 'Bearer YOUR_APIFY_TOKEN',
    },
});

console.log(resp.data);
```

- part of the result: 
```json
{
  "title": "Apify Blog",
  "allLinks": [
    {
      "title": "Data for generative AI & LLM",
      "link": "https://apify.com/data-for-generative-ai"
    },
    {
      "title": "Product matching AI",
      "link": "https://apify.com/product-matching-ai"
    },
    {
      "title": "Universal web scrapers",
      "link": "https://apify.com/store/scrapers/universal-web-scrapers"
    },
    ... more links
  ]
}
```

### JS Scenario

Specify instructions in order to be executed one by one after opening the page. Set `json_response` to `true` to get a full report of the performed instructions, the results of `evaluate` instructions will be added to the `evaluate_results` field.

- example for clicking a button:
```ts
const instructions = {
    instructions: [
        { click: '#button' },
    ],
};

const resp = await axios.get('https://yh8jx5mCjfv69espW.apify.actor/', {
    params: {
        url: 'some url',
        js_scenario: JSON.stringify(instructions),
    },
    headers: {
        Authorization: 'Bearer YOUR_APIFY_TOKEN',
    },
});

console.log(resp.data);
```

#### Strict mode

If one instructions fails, then the subsequent instructions will not be executed. To disable this, you can optionally set `strict` to `false` (which is `true` by default):

```json
{
    "instructions": [
        { "click": "#button1" },
        { "click": "#button2" },
    ],
    "strict": false
};
```

#### Supported instructions:

##### wait

- wait for some time specified in ms
- example: `{"wait": 10000}`

##### wait_for

- wait for an element specified by selector
- example `{"wait_for": "#element"}`

##### click

- click on an element specified by the selector
- example `{"click": "#button"}`

##### wait_for_and_click
- combination of previous two
- example `{"wait_for_and_click": "#button"}`

##### scroll x/y

- scroll specified number of pixels horizontally or vertically
- example `{"scroll_y": 1000}` or `{"scroll_x": 1000}`

##### fill

- specify selector of the input element and the value you want to fill
- example `{"fill": ["input_1", "value_1"]}`

##### evaluate

- evaluate custom javascript on the webpage
- text/number/object results will be saved in `evaluate_results` field
- example `{"evaluate":"document.querySelectorAll('a').length"}`
